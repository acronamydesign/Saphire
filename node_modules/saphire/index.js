//Master file
//This file is manditory but is not a core module, instead it allows for teamwork between other saphire modules.
var saphireGlobals = require("./globals.js"),
		loadMainPackageJSON = require("./models/main-package.js"),
		utils = require("./models/utils.js"),
		buildAdminMenu = require("./conditional/build-admin-menu.js"),
		cores = require("./models/core-definitions.js"),
		buildSaphireRegistry = require("./models/build-registry.js"),
		ifCoresExist = require("./models/check-cores.js")

//prepare conditional exports
var exportable = {}
var buildAdminMenu = buildAdminMenu.bind(exportable)

//Always export
exportable["functions"] = utils;

//build the saphire registry to run multipurpose code if apropriate, use check cores function.
var saphireRegistry = buildSaphireRegistry(loadMainPackageJSON())

//shorthand syntax
//checkCores(cores.regions, buildAdminMenu(saphireRegistry));


ifCoresExist({
	installed:[
		"regions"
	]
},{
	exec:[
		[buildAdminMenu, saphireRegistry]
	]
});


module.exports = exportable;

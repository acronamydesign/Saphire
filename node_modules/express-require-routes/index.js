var fs = require('fs'),
    path = require('path');

var requireRoutes = function(absoluteDir, app) {
    var files = fs.readdirSync(absoluteDir);

    files.forEach(function(file) {
        var absolutePath = path.join(absoluteDir, file);

        var stat = fs.statSync(absolutePath);

        if (stat.isFile()) {
            try {
                var routes = require(absolutePath);
                routes(app);
            } catch (e) {
                console.log('Could not require route "' + absolutePath + '" due to exception', e);
            }
        } else if (stat.isDirectory()) {
            // Scan the directory recursive
            requireRoutes(path.join(absoluteDir, file), app);
        }
    });
}

var requireRoutesAbsolute = function(dir, app) {
    var absoluteDir = path.join(process.cwd(), dir);

    requireRoutes(absoluteDir, app);
}

module.exports = requireRoutesAbsolute;